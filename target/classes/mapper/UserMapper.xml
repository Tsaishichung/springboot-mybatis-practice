<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.cust.course.Course.common.mapper.UserMapper">
  <resultMap id="BaseResultMap" type="edu.cust.course.Course.common.model.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 00:35:15 CST 2016.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="account" jdbcType="VARCHAR" property="account" />
    <result column="username" jdbcType="VARCHAR" property="username" />
    <result column="password" jdbcType="VARCHAR" property="password" />
    <result column="sex" jdbcType="INTEGER" property="sex" />
    <result column="phone" jdbcType="VARCHAR" property="phone" />
    <result column="user_pic" jdbcType="VARCHAR" property="userPic" />
    <result column="is_used" jdbcType="INTEGER" property="isUsed" />
    <result column="create_time" jdbcType="DATE" property="createTime" />
    <result column="is_vip" jdbcType="INTEGER" property="isVip" />
    <result column="is_manage" jdbcType="INTEGER" property="isManage" />
  </resultMap>
  <sql id="user">
  	id,account,username,password,sex,phone,user_pic,is_used,create_time,is_vip,is_manage
  </sql>
  <!-- 用户登录 -->
  <select id="login" resultMap="BaseResultMap">
  		select * from users where account=#{param1} and password=#{param2}
  </select>
  <!-- 获取文章信息中的作者一项信息 -->
  <select id="selectUserById" parameterType="int" resultMap="BaseResultMap">
		select * from users where id=#{param1}  
  </select>
  <!-- 用户注册 -->
  <insert id="userRegister" parameterType="edu.cust.course.Course.common.model.User"  useGeneratedKeys="true" keyProperty="id">
  insert into users 
  		(<if test="account!=null">account</if>
  		<if test="username!=null">,username</if>
  		<if test="password!=null">,password</if>
  		<if test="sex!=null">,sex</if>
  		<if test="phone!=null">,phone</if>)
  		values(<if test="account!=null">#{account}</if>
  		<if test="username!=null">,#{username}</if>
  		<if test="password!=null">,#{password}</if>
  		<if test="sex!=null">,#{sex}</if>
  		<if test="phone!=null">,#{phone}</if>)
  </insert>
  <!-- 修改用户信息 -->
  <update id="updateUserInfo" parameterType="edu.cust.course.Course.common.model.User">
  	update users set username=#{username},sex=#{sex},phone=#{phone} where id=#{id}
  </update>
  <!-- 后台登录 -->
  <select id="manageLogin" parameterType="edu.cust.course.Course.common.model.User" resultMap="BaseResultMap">
  	select * from users where account=#{account} and password=#{password} and is_manage=1
  </select>
  <!-- 后台用户总数获取 -->
  <select id="manageUserCount"  resultType="int">
  	select count(*) from users where is_manage=3;
  </select>
   <!-- 后台用户信息获取 -->
  <select id="manageUserInfo" parameterType="map" resultMap="BaseResultMap">
  	select * from users where is_manage=3 order by id asc limit #{page_size} offset #{start_size}
  </select>
  <!-- 禁用用户 -->
  <select id="selectUserStatus" parameterType="int" resultType="int">
  	select is_used from users where id=#{id}
  </select>
  <update id="forbidUser" parameterType="int">
  	update users set is_used=#{param2} where id=#{param1} 
  </update>
   <!-- 重置密码用户 -->
  <update id="resetPwdUser" parameterType="int">
  	update users set password='123' where id=#{id}
  </update>
</mapper>